import numpy as np
import matplotlib.pyplot as plt

lambda_1 = 1.0722
lambda_2 = 0.48976
sigma_1 = 8.4733*10**(-4)
sigma_2 = 5.0201*10**(-6)
a = 2*(lambda_1-lambda_2)**2*sigma_1*sigma_2
b = (sigma_1+sigma_2)**2*(lambda_1*sigma_2+lambda_2*sigma_1)
# c = (sigma_1+sigma_2)**3*(lambda_1*sigma_2+lambda_2*sigma_1)*t
# d = 1-np.e**((-sigma_1+sigma_2)*t)
I = 1.+(2*(lambda_1-lambda_2)**2*sigma_1*sigma_2)/((sigma_1+sigma_2)**2*(lambda_1*sigma_2+lambda_2*sigma_1))
J = 1. + a/b
k = []      # I_t
Tp = (lambda_1*sigma_2+lambda_2*sigma_1)/(sigma_1+sigma_2) # lambda 的均值
for t in range(1, 10000):
    c = (sigma_1+sigma_2)**3*(lambda_1*sigma_2+lambda_2*sigma_1)*t
    d = 1 - np.e ** ((-sigma_1 + sigma_2) * t)
    K = J - a/c*d
    k.append(K)
# the vartual waiting time distribution
u = 2.181162
g_1 =0.00588774 # (sigma_2*lambda_2)/(lambda_1*sigma_1+lambda_2*sigma_2)
g_2 = 0.99411226 # (sigma_1*lambda_1)/(lambda_1*sigma_1+lambda_2*sigma_2)

print(sigma_1+sigma_2)
print(g_1*lambda_2+g_2*lambda_1)
print(sigma_1*sigma_2)
print("g 的稳态分布：%f %f" %(g_1, g_2))
w = []      # vartual waiting time
w_aa = []   # the waiting time at customer arrival instants
for s in range(1, 41):
    h = -s/(s+u)
    w_1 = 0.51*s*(s-sigma_1-sigma_2)+h*(g_1*lambda_2+g_2*lambda_1)
    # w_2 = (s+lambda_1*h-sigma_1)*(s+lambda_2*h-sigma_2)-sigma_1*sigma_2
    w_2 = s*s+(h*(lambda_1+lambda_2)-(sigma_1-sigma_2))*s+h*(h*lambda_1*lambda_2-sigma_1*lambda_2-sigma_2*lambda_1)
    w_v = w_1/w_2
    w_a = (s+u)/Tp * (w_v-0.51)
    w.append(w_v)
    w_aa.append(w_a)

# the arrival interval
l = []
interval = []
for s in range(0,30):
    l_1 = (0.209015861*s + 0.220922157)/(0.4203708920*(s**2+1.562812350*s+0.525541043))
    l_2 = 0.49*np.e**(-0.48976*s)+0.01*np.e**(-1.0722*s)
    l.append(l_1)
    interval.append(l_2)

T = [i for i in range(1, 10000)]
# --------------------------------------------I_t 的变化图------------------------------------------
fig= plt.figure(1)
plt.plot(T,k)
plt.title('I_t')

v = []
for t in range(1,10000):
    s = Tp*t
    v.append(s)
# --------------------------------------------N_t 的变化图------------------------------------------
fig= plt.figure(2)
plt.plot(T,v)
plt.title('N_t')

def p(x, y):
    return x*y
s = list(map(p,k,v))
# print(s)

# --------------------------------------------N_t * I_t--------------------------------------------
fig= plt.figure(3)
plt.plot(T,s)
plt.title('N_t * I_t')

s = [i for i in range(1,41)]
# --------------------------------------------the vartual waiting time distribution-----------------
fig= plt.figure(4)
plt.plot(s,w,'b',label = "the vartual waiting time")
plt.plot(s,w_aa,'r', label = "the waiting time arrival instants")
plt.title('The waiting time distribution')
plt.xlabel('time')# make axis labels
plt.ylabel('probability')
plt.legend()
# --------------------------------------------the arrival interval-----------------------------------
inter = [i for i in range(0,30)]
fig= plt.figure(5)
plt.plot(inter,l,'b',label = "the LST of arrival interval")
plt.plot(inter,interval,'r', label = "the arrival interval")
plt.title('The arrival interval')
plt.legend()

# --------------------------------------------u = 2.181162的指数分布------------------------------------------
fig= plt.figure(8)
u = 2.181162
x = np.arange(0, 10, 1)
y = (1/u)*np.exp(-x/u)
plt.plot(x,y)
plt.title('Exponential: 1/$\mu$=%f' % u)

# --------------------------------------------packet loss-------------------------------------------
cwnd = ['2800', '4200', '5600', '7000', '8400', '9800', '11200', '12600', '14000', '15400', '16800', '18200', '19600', '21000', '22400', '23800', '25200', '26600', '28000', '29400', '30800', '32200', '33600', '35000', '36400', '37800', '39200', '40600', '42000', '43400', '44800', '46200', '47600', '49000', '50400', '51800', '53200', '54600', '56000', '57400', '58800', '60200', '61600', '63000', '64400', '65800', '65829', '65858', '65887', '65916', '65945', '65974', '66003', '66032', '66061', '66090', '66119', '66148', '66177', '66206', '66235', '66264', '66293', '66322', '66351', '66380', '66409', '66438', '66467', '66496', '66525', '66554', '66583', '66612', '66641', '66670', '66699', '66728', '66757', '66786', '66815', '66844', '66873', '66902', '66931', '66960', '66989', '67018', '67047', '67076', '67105', '67134', '67163', '67192', '67221', '67250', '67279', '67308', '67337', '67366', '67395', '67424', '67453', '67482', '67511', '67540', '67569', '67598', '67626', '67654', '67682', '67710', '67738', '67766', '67794', '67822', '67850', '67878', '67906', '67934', '67962', '67990', '68018', '68046', '68074', '68102', '68130', '68158', '68186', '68214', '68242', '68270', '68298', '68326', '68354', '68382', '68410', '68438', '68466', '68494', '68522', '68550', '68578', '68606', '68634', '68662', '68690', '68718', '68746', '68774', '68802', '68830', '68858', '68886', '68914', '68942', '68970', '68998', '69026', '69054', '69082', '69110', '69138', '69166', '69194', '69222', '69250', '69278', '69306', '69334', '69362', '69390', '69418', '69446', '69474', '69502', '69530', '69558', '69586', '69614', '69642', '69670', '69698', '69726', '69754', '69782', '69810', '69838', '69866', '69894', '69922', '69950', '69978', '70006', '70033', '70060', '70087', '70114', '70141', '70168', '70195', '70222', '70249', '70276', '70303', '70330', '70357', '70384', '70411', '70438', '70465', '70492', '70519', '70546', '70573', '70600', '70627', '70654', '70681', '70708', '70735', '70762', '70789', '70816', '70843', '70870', '70897', '70924', '70951', '70978', '71005', '71032', '1400', '2800', '4200', '5600', '7000', '8400', '9800', '11200', '12600', '14000', '15400', '16800', '18200', '19600', '21000', '22400', '23800', '25200', '26600', '28000', '29400', '30800', '32200', '33600', '35000', '36400', '36453', '36506', '36559', '36612', '36665', '36718', '36771', '36824', '36877', '36930', '36983', '37035', '37087', '37139', '37191', '37243', '37295', '37347', '37399', '37451', '37503', '37555', '37607', '37659', '37711', '37762', '37813', '37864', '37915', '37966', '38017', '38068', '38119', '38170', '38221', '38272', '38323', '38374', '38425', '38476', '38526', '38576', '38626', '38676', '38726', '38776', '38826', '38876', '38926', '38976', '39026', '39076', '39126', '39176', '39226', '39275', '39324', '39373', '39422', '39471', '39520', '39569', '39618', '39667', '39716', '39765', '39814', '39863', '39912', '39961', '40010', '40058', '40106', '40154', '40202', '40250', '40298', '40346', '40394', '40442', '40490', '40538', '40586', '40634', '40682', '40730', '40778', '40826', '20413', '10206', '11606', '11774', '11940', '12104', '12265', '12424', '12581', '12736', '12889', '13041', '13191', '13339', '13485', '13630', '13773', '13915', '14055', '14194', '14332', '14468', '14603', '14737', '14869', '15000', '15130', '15259', '15387', '15514', '15640', '15765', '15889', '16012', '16134', '16255', '16375', '16494', '16612', '16729', '16846', '16962', '17077', '17191', '17305', '17418', '17530', '17641', '17752', '17862', '17971', '18080', '18188', '18295', '18402', '18508', '18613', '18718', '18822', '18926', '19029', '19132', '19234', '19335', '19436', '19536', '19636', '19735', '19834', '19932', '20030', '20127', '20224', '20320', '20416', '20512', '20607', '20702', '20796', '20890', '20983', '21076', '21168', '21260', '21352', '21443', '21534', '21625', '21715', '21805', '21894', '21983', '22072', '22160', '22248', '22336', '22423', '22510', '22597', '22683', '22769', '22855', '22940', '23025', '23110', '23194', '23278', '23362', '23445', '23528', '23611', '23694', '23776', '23858', '23940', '24021', '24102', '24183', '24264', '24344', '24424', '24504', '24583', '24662', '24741', '24820', '24898', '24976', '25054', '25132', '25209', '25286', '25363', '25440', '25517', '25593', '25669', '25745', '25821', '25896', '25971', '26046', '26121', '26196', '26270', '26344', '26418', '26492', '26565', '26638', '26711', '26784', '26857', '26929', '27001', '27073', '27145', '27217', '27289', '27360', '27431', '27502', '27573', '27644', '27714', '27784', '27854', '27924', '27994', '28064', '28133', '28202', '28271', '28340', '28409', '28477', '28545', '28613', '28681', '28749', '28817', '28885', '28952', '29019', '29086', '29153', '29220', '29287', '29353', '29419', '29485', '29551', '29617', '29683', '29749', '29814', '29879', '29944', '30009', '30074', '30139', '30204', '30268', '30332', '30396', '30460', '30524', '30588', '30652', '30715', '30778', '30841', '30904', '30967', '31030', '31093', '31156', '31218', '31280', '31342', '31404', '31466', '31528', '31590', '31652', '31713', '31774', '31835', '31896', '31957', '32018', '32079', '32140', '32200', '32260', '32320', '32380', '32440', '32500', '32560', '32620', '32680', '32739', '32798', '32857', '32916', '32975', '33034', '33093', '33152', '33211', '33270', '33328', '33386', '33444', '33502', '33560', '33618', '33676', '33734', '33792', '33850', '33907', '33964', '34021', '34078', '34135', '34192', '34249', '34306', '34363', '34420', '34476', '34532', '34588', '34644', '34700', '34756', '34812', '34868', '34924', '34980', '35036', '35091', '35146', '35201', '35256', '35311', '35366', '35421', '35476', '35531', '35586', '35641', '35695', '35749', '35803', '35857', '35911', '35965', '36019', '36073', '36127', '36181', '36235', '36289', '36343', '36396', '36449', '36502', '36555', '36608', '36661', '36714', '36767', '36820', '36873', '36926', '36979', '37032', '37084', '37136', '37188', '37240', '37292', '37344', '37396', '37448', '37500', '37552', '37604', '37656', '37708', '37759', '37810', '37861', '37912', '37963', '38014', '38065', '38116', '38167', '38218', '38269', '38320', '38371', '38422', '38473', '38523', '38573', '38623', '38673', '38723', '38773', '38823', '38873', '38923', '38973', '39023', '39073', '39123', '39173', '39223', '39272', '39321', '39370', '39419', '39468', '39517', '39566', '39615', '39664', '39713', '39762', '39811', '39860', '39909', '39958', '40007', '40055', '40103', '40151', '40199', '40247', '40295', '40343', '40391', '40439', '40487', '40535', '40583', '40631', '40679', '40727', '40775', '40823', '40871', '40918', '40965', '41012', '41059', '41106', '41153', '41200', '41247', '41294', '41341', '41388', '41435', '41482', '41529', '41576', '41623', '41670', '41717', '41763', '41809', '41855', '41901', '41947', '41993', '42039', '42085', '42131', '42177', '42223', '42269', '42315', '42361', '42407', '42453', '42499', '42545', '42591', '42637', '42682', '42727', '42772', '42817', '42862', '42907', '42952', '42997', '43042', '43087', '43132', '43177', '43222', '43267', '43312', '43357', '43402', '43447', '43492', '43537', '43582', '43626', '43670', '43714', '43758', '43802', '43846', '43890', '43934', '43978', '44022', '44066', '44110', '44154', '44198', '44242', '44286', '44330', '44374', '44418', '44462', '44506', '44550', '44593', '44636', '44679', '44722', '44765', '44808', '44851', '44894', '44937', '44980', '45023', '45066', '45109', '45152', '45195', '45238', '45281', '45324', '45367', '45410', '45453', '45496', '45539', '45582', '45624', '45666', '45708', '45750', '45792', '45834', '45876', '45918', '45960', '46002', '46044', '46086', '46128', '46170', '46212', '46254', '46296', '46338', '46380', '46422', '46464', '46506', '46548', '46590', '46632', '46674', '46715', '46756', '46797', '46838', '46879', '46920', '46961', '47002', '47043', '47084', '47125', '47166', '47207', '47248', '47289', '47330', '47371', '47412', '47453', '47494', '47535', '47576', '47617', '47658', '47699', '47740', '47781', '47822', '47862', '47902', '47942', '47982', '48022', '48062', '48102', '48142', '48182', '48222', '48262', '48302', '48342', '48382', '48422', '48462', '48502', '48542', '48582', '48622', '48662', '48702', '48742', '48782', '48822', '48862', '48902', '48942', '48982', '49022', '49061', '49100', '49139', '49178', '49217', '49256', '49295', '49334', '49373', '49412', '49451', '49490', '49529', '49568', '49607', '49646', '49685', '49724', '49763', '49802', '49841', '49880', '49919', '49958', '49997', '50036', '50075', '50114', '50153', '50192', '50231', '50270', '50308', '50346', '50384', '50422', '50460', '50498', '50536', '50574', '50612', '50650', '50688', '50726', '50764', '50802', '50840', '50878', '50916', '50954', '50992', '51030', '51068', '51106', '51144', '51182', '51220', '51258', '51296', '51334', '51372', '51410', '51448', '51486', '51524', '51562', '51600', '51637', '51674', '51711', '51748', '51785', '51822', '51859', '51896', '51933', '51970', '52007', '52044', '52081', '52118', '52155', '52192', '52229', '52266', '52303', '52340', '52377', '52414', '52451', '52488', '52525', '52562', '52599', '52636', '52673', '52710', '52747', '52784', '52821', '52858', '52895', '52932', '52969', '53006', '53042', '53078', '53114', '53150', '53186', '53222', '53258', '53294', '53330', '53366', '53402', '53438', '53474', '53510', '53546', '53582', '53618', '53654', '53690', '53726', '53762', '53798', '53834', '53870', '53906', '53942', '53978', '54014', '54050', '54086', '54122', '54158', '54194', '54230', '54266', '54302', '1400', '2800', '4200', '5600', '7000', '8400', '9800', '11200', '12600', '14000', '15400', '16800', '18200', '19600', '21000', '22400', '23800', '25200', '26600', '28000', '28070', '28139', '28208', '28277', '28346', '28415', '28483', '28551', '28619', '28687', '28755', '28823', '28891', '28958', '29025', '29092', '29159', '29226', '29293', '29359', '29425', '29491', '29557', '29623', '29689', '29755', '29820', '29885', '29950', '30015', '30080', '30145', '30210', '30274', '30338', '30402', '30466', '30530', '30594', '30658', '30721', '30784', '30847', '30910', '30973', '31036', '31099', '31162', '31224', '31286', '31348', '31410', '31472', '31534', '31596', '31658', '31719', '31780', '31841', '31902', '31963', '32024', '32085', '32146', '32206', '32266', '32326', '32386', '32446', '32506', '32566', '32626', '32686', '32745', '32804', '32863', '32922', '32981', '33040', '33099', '33158', '33217', '33276', '33334', '33392', '33450', '33508', '33566', '33624', '33682', '33740', '33798', '33855', '33912', '33969', '34026', '34083', '34140', '34197', '34254', '34311', '34368', '34425', '34481', '34537', '34593', '34649', '34705', '34761', '34817', '34873', '34929', '34985', '35041', '35096', '35151', '35206', '35261', '35316', '35371', '35426', '35481', '35536', '35591', '35646', '35700', '35754', '35808', '35862', '35916', '35970', '36024', '36078', '36132', '36186', '36240', '36294', '36348', '36401', '36454', '36507', '36560', '36613', '36666', '36719', '36772', '36825', '36878', '36931', '36984', '37036', '37088', '37140', '37192', '37244', '37296', '37348', '37400', '37452', '37504', '37556', '37608', '37660', '37712', '37763', '37814', '37865', '37916', '37967', '38018', '38069', '38120', '38171', '38222', '38273', '38324', '38375', '38426', '38477', '38527', '38577', '38627', '38677', '38727', '38777', '38827', '38877', '38927', '38977', '39027', '39077', '39127', '39177', '39227', '39276', '39325', '39374', '39423', '39472', '39521', '39570', '39619', '39668', '39717', '39766', '39815', '39864', '39913', '39962', '40011', '40059', '40107', '40155', '40203', '40251', '40299', '40347', '40395', '40443', '40491', '40539', '40587', '40635', '40683', '40731', '40779', '40827', '40875', '40922', '40969', '41016', '41063', '41110', '41157', '41204', '41251', '41298', '41345', '41392', '41439', '41486', '41533', '41580', '41627', '41674', '41721', '41767', '41813', '41859', '41905', '41951', '41997', '42043', '42089', '42135', '42181', '42227', '42273', '42319', '42365', '42411', '42457', '42503', '42549', '42595', '42641', '42686', '42731', '42776', '42821', '42866', '42911', '42956', '43001', '43046', '43091', '43136', '43181', '43226', '43271', '43316', '43361', '43406', '43451', '43496', '43541', '43586', '43630', '43674', '43718', '43762', '43806', '43850', '43894', '43938', '43982', '44026', '44070', '44114', '44158', '44202', '44246', '44290', '44334', '44378', '44422', '44466', '44510', '44554', '44597', '44640', '44683', '44726', '44769', '44812', '44855', '44898', '44941', '44984', '45027', '45070', '45113', '45156', '45199', '45242', '45285', '45328', '45371', '45414', '45457', '45500', '45543', '45586', '45628', '45670', '45712', '45754', '45796', '45838', '45880', '45922', '45964', '46006', '46048', '46090', '46132', '46174', '46216', '46258', '46300', '46342', '46384', '46426', '46468', '46510', '46552', '46594', '46636', '46678', '46719', '46760', '46801', '46842', '46883', '46924', '46965', '47006', '47047', '47088', '47129', '47170', '47211', '47252', '47293', '47334', '47375', '47416', '47457', '47498', '47539', '47580', '47621', '47662', '47703', '47744', '47785', '47826', '47866', '47906', '47946', '47986', '48026', '48066', '48106', '48146', '48186', '48226', '48266', '48306', '48346', '48386', '48426', '48466', '48506', '48546', '48586', '48626', '48666', '48706', '48746', '48786', '48826', '48866', '48906', '48946', '48986', '49026', '49065', '49104', '49143', '49182', '49221', '49260', '49299', '49338', '49377', '49416', '49455', '49494', '49533', '49572', '49611', '49650', '49689', '49728', '49767', '49806', '49845', '49884', '49923', '49962', '50001', '50040', '50079', '50118', '50157', '50196', '50235', '50274', '50312', '50350', '50388', '50426', '50464', '50502', '50540', '50578', '50616', '50654', '50692', '50730', '50768', '50806', '50844', '50882', '50920', '50958', '50996', '51034', '51072', '51110', '51148', '51186', '51224', '51262', '51300', '51338', '51376', '51414', '51452', '51490', '51528', '51566', '51604', '51641', '51678', '51715', '51752', '51789', '51826', '51863', '51900', '51937', '51974', '52011', '52048', '52085', '52122', '52159', '52196', '52233', '52270', '52307', '52344', '52381', '52418', '52455', '52492', '52529', '52566', '52603', '52640', '52677', '52714', '52751', '52788', '52825', '52862', '52899', '52936', '52973', '53009', '53045', '53081', '53117', '53153', '53189', '53225', '53261', '53297', '53333', '53369', '53405', '53441', '53477', '53513', '53549', '53585', '53621', '53657', '53693', '53729', '53765', '53801', '53837', '53873', '53909', '53945', '53981', '54017', '54053', '54089', '54125', '54161', '54197', '54233', '54269', '54305', '54341', '54377', '54413', '54449', '54484', '54519', '54554', '54589', '54624', '54659', '54694', '54729', '54764', '54799', '54834', '54869', '54904', '54939', '54974', '55009', '55044', '55079', '55114', '55149', '55184', '55219', '55254', '55289', '55324', '55359', '55394', '55429', '55464', '55499', '55534', '55569', '55604', '55639', '55674', '55709', '55744', '55779', '55814', '55849', '55884', '55919', '55954', '55989', '56024', '56058', '56092', '56126', '56160', '56194', '56228', '56262', '56296', '56330', '56364', '56398', '56432', '56466', '56500', '56534', '56568', '56602', '56636', '56670', '56704', '56738', '56772', '56806', '56840', '56874', '56908', '56942', '56976', '57010', '57044', '57078', '57112', '57146', '57180', '57214', '57248', '57282', '57316', '57350', '57384', '57418', '57452', '57486', '57520', '57554', '57588', '57622', '57656', '57689', '57722', '57755', '57788', '57821', '57854', '57887', '57920', '57953', '57986', '58019', '58052', '58085', '58118', '58151', '58184', '58217', '58250', '58283', '58316', '58349', '58382', '58415', '58448', '58481', '58514', '58547', '58580', '58613', '58646', '58679', '58712', '58745', '58778', '58811', '58844', '58877', '58910', '58943', '58976', '59009', '59042', '59075', '59108', '59141', '59174', '59207', '59240', '59273', '59306', '59339', '59372', '59405', '59437', '59469', '29734', '31134', '31196', '31258', '31320', '31382', '31444', '31506', '31568', '31630', '31691', '31752', '31813', '31874', '31935', '31996', '32057', '32118', '32179', '32239', '32299', '32359', '32419', '32479', '32539', '32599', '32659', '32719', '32778', '32837', '32896', '32955', '33014', '33073', '33132', '33191', '33250', '33308', '33366', '33424', '33482', '33540', '33598', '33656', '33714', '33772', '33830', '33887', '33944', '34001', '34058', '34115', '34172', '34229', '34286', '34343', '34400', '34456', '34512', '34568', '34624', '34680', '34736', '34792', '34848', '34904', '34960', '35016', '35071', '35126', '35181', '35236', '35291', '35346', '35401', '35456', '35511', '35566', '35621', '35676', '35730', '35784', '35838', '35892', '35946', '36000', '36054', '36108', '36162', '36216', '36270', '36324', '36377', '36430', '36483', '36536', '36589', '36642', '36695', '36748', '36801', '36854', '36907', '36960', '37013', '37065', '37117', '37169', '37221', '37273', '37325', '37377', '37429', '37481', '37533', '37585', '37637', '37689', '37741', '37792', '37843', '37894', '37945', '37996', '38047', '38098', '38149', '38200', '38251', '38302', '38353', '38404', '38455', '38505', '38555', '38605', '38655', '38705', '38755', '38805', '38855', '38905', '38955', '39005', '39055', '19527', '20927', '21020', '21113', '21205', '21297', '21389', '21480', '21571', '21661', '21751', '21841', '21930', '22019', '22108', '22196', '22284', '22371', '22458', '22545', '22631', '22717', '22803', '22888', '22973', '23058', '23143', '23227', '23311', '23395', '23478', '23561', '23644', '23726', '23808', '23890', '23972', '24053', '24134', '24215', '24295', '24375', '24455', '24535', '24614', '24693', '24772', '24851', '24929', '25007', '25085', '25163', '25240', '25317', '25394', '25471', '25547', '25623', '25699', '25775', '25851', '25926', '26001', '26076', '26151', '26225', '26299', '26373', '26447', '26521', '26594', '26667', '26740', '26813', '26886', '26958', '27030', '27102', '27174', '27246', '27317', '27388', '27459', '27530', '27601', '27672', '27742', '27812', '27882', '27952', '28022', '28091', '28160', '28229', '28298', '28367', '28436', '28504', '28572', '28640', '28708', '28776', '28844', '28911', '28978', '29045', '29112', '29179', '29246', '29313', '29379', '29445', '29511', '29577', '29643', '29709', '29774', '29839', '29904', '29969', '30034', '30099', '30164', '30228', '30292', '30356', '30420', '30484', '30548', '30612', '30676', '30739', '30802', '30865', '30928', '30991', '31054', '31117', '31179', '31241', '31303', '31365', '31427', '31489', '31551', '31613', '31674', '31735', '31796', '31857', '31918', '31979', '32040', '32101', '32162', '32222', '32282', '32342', '32402', '32462', '32522', '32582', '32642', '32702', '32761', '32820', '32879', '32938', '32997', '16498', '8249', '9649', '9852', '10050', '10245', '10436', '10623', '10807', '10988', '11166', '11341', '11513', '11683', '11850', '12015', '12178', '12338', '12496', '12652', '12806', '12959', '13110', '13259', '13406', '13552', '13696', '13839', '13980', '14120', '14258', '14395', '14531', '14665', '14798', '14930', '15061', '15191', '15320', '15447', '15573', '15698', '15822', '15945', '16067', '16188', '16309', '16429', '16548', '16666', '16783', '16899', '17014', '17129', '17243', '17356', '17468', '17580', '17691', '17801', '17911', '18020', '18128', '18236', '18343', '18449', '18555', '18660', '18765', '18869', '18972', '19075', '19177', '19279', '19380', '19481', '19581', '19681', '19780', '19879', '19977', '20075', '20172', '20269', '20365', '20461', '20556', '20651', '20745', '20839', '20933', '21026', '21119', '21211', '21303', '21395', '21486', '21577', '21667', '21757', '21847', '21936', '22025', '22113', '22201', '22289', '22376', '22463', '22550', '22636', '22722', '22808', '22893', '22978', '23063', '23147', '23231', '23315', '23399', '23482', '23565', '23648', '23730', '23812', '23894', '23976', '24057', '24138', '24219', '24299', '24379', '24459', '24539', '24618', '24697', '24776', '24855', '24933', '25011', '25089', '25167', '25244', '25321', '25398', '25475', '25551', '25627', '25703', '25779', '25855', '25930', '26005', '26080', '26155', '26229', '26303', '26377', '26451', '26525', '26598', '26671', '26744', '26817', '26890', '26962', '27034', '27106', '27178', '27250', '27321', '27392', '27463', '27534', '27605', '27676', '27746', '27816', '27886', '27956', '28026', '28095', '28164', '28233', '28302', '28371', '28440', '28508', '28576', '28644', '28712', '28780', '28848', '28915', '28982', '29049', '29116', '29183', '29250', '29317', '29383', '29449', '29515', '29581', '29647', '29713', '29778', '29843', '29908', '29973', '30038', '30103', '30168', '30232', '30296', '30360', '30424', '30488', '30552', '30616', '30680', '30743', '30806', '30869', '30932', '30995', '31058', '31121', '31183', '31245', '31307', '31369', '31431', '31493', '31555', '31617', '31678', '31739', '31800', '31861', '31922', '31983', '32044', '32105', '32166', '32226', '32286', '32346', '32406', '32466', '32526', '32586', '32646', '32706', '32765', '32824', '32883', '32942', '33001', '1400', '2800', '4200', '5600', '7000', '8400', '9800', '11200', '12600', '14000', '15400', '16800', '16916', '17031', '17146', '17260', '17373', '17485', '17597', '17708', '17818', '17928', '18037', '18145', '18253', '18360', '18466', '18572', '18677', '18781', '18885', '18988', '19091', '19193', '19295', '19396', '19497', '19597', '19697', '19796', '19895', '19993', '20091', '20188', '20285', '20381', '20477', '20572', '20667', '20761', '20855', '20948', '21041', '21134', '21226', '21318', '21409', '21500', '21591', '21681', '21771', '21861', '21950', '22039', '22127', '22215', '22303', '22390', '22477', '22564', '22650', '22736', '22822', '22907', '22992', '23077', '23161', '23245', '23329', '23413', '23496', '23579', '23662', '23744', '23826', '23908', '23989', '24070', '24151', '24232', '24312', '24392', '24472', '24552', '24631', '24710', '24789', '24868', '24946', '25024', '25102', '25180', '25257', '25334', '25411', '25488', '25564', '25640', '25716', '25792', '25867', '25942', '26017', '26092', '26167', '26241', '26315', '26389', '26463', '1400', '1400', '2800', '4200', '4666', '5086', '5471', '5829', '6165', '6482', '6784', '7072', '7349', '7615', '7872', '8120', '8361', '8595', '8823', '9045', '9261', '9472', '9678', '9880', '10078', '10272', '10462', '10649', '10833', '11013', '11190', '11365', '11537', '11706', '11873', '12038', '12200', '12360', '12518', '12674', '12828', '12980', '13131', '13280', '13427', '13572', '13716', '13858', '13999', '14139', '14277', '14414', '14549', '14683', '14816', '14948', '15079', '15208', '15336', '15463', '15589', '15714', '15838', '15961', '16083', '16204', '16324', '16444', '16563', '16681', '16798', '16914', '17029', '17144', '17258', '17371', '17483', '17595', '17706', '17816', '17926', '18035', '18143', '18251', '18358', '18464', '18570', '18675', '18779', '18883', '18986', '19089', '19191', '19293', '19394', '19495', '19595', '19695', '19794', '19893', '19991', '20089', '20186', '20283', '20379', '20475', '20570', '20665', '20759', '20853', '20946', '21039', '21132', '21224', '21316', '21407', '21498', '21589', '21679', '21769', '21859', '21948', '22037', '22125', '22213', '22301', '22388', '22475', '22562', '22648', '22734', '22820', '22905', '22990', '23075', '23159', '23243', '23327', '23411', '23494', '23577', '23660', '23742', '23824', '23906', '23987', '24068', '24149', '24230', '24310', '24390', '24470', '24550', '24629', '24708', '24787', '24866', '24944', '25022', '25100', '25178', '25255', '25332', '25409', '25486', '25562', '25638', '25714', '25790', '25865', '25940', '26015', '26090', '26165', '26239', '26313', '26387', '26461', '26535', '26608', '26681', '26754', '26827', '26900', '26972', '27044', '27116', '27188', '27260', '27331', '27402', '27473', '27544', '27615', '27685', '27755', '27825', '27895', '27965', '28035', '28104', '28173', '28242', '28311', '28380', '28449', '28517', '28585', '28653', '28721', '28789', '28857', '28924', '28991', '29058', '29125', '29192', '29259', '29325', '29391', '29457', '29523', '29589', '29655', '29721', '29786', '29851', '29916', '29981', '30046', '30111', '30176', '30240', '30304', '30368', '30432', '30496', '30560', '30624', '30688', '30751', '30814', '30877', '30940', '31003', '31066', '31129', '31191', '31253', '31315', '31377', '31439', '31501', '31563', '31625', '31686', '31747', '31808', '31869', '31930', '31991', '32052', '32113', '32174', '32234', '32294', '32354', '32414', '32474', '32534', '32594', '32654', '32714', '32773', '32832', '32891', '32950', '33009', '33068', '33127', '33186', '33245', '33303', '33361', '33419', '33477', '33535', '33593', '33651', '33709', '33767', '33825', '33882', '33939', '33996', '34053', '34110', '34167', '34224', '34281', '34338', '34395', '34451', '34507', '34563', '34619', '34675', '34731', '34787', '34843', '34899', '34955', '35011', '35066', '35121', '35176', '35231', '35286', '35341', '35396', '35451', '35506', '35561', '35616', '35671', '35725', '35779', '35833', '35887', '35941', '35995', '36049', '36103', '36157', '36211']
a = []
P = 0.001
q = []      # packet loss
for i in cwnd:
    i = int(i)/1400
    a.append(i)
for i in sorted(a):
    if i <= 3:
        q_i = 1.
    else:
        q_i = ((1-(1-P)**3)*(1+(1-P)**3-(1-P)**i)) / (1-(1-P)**i)
    q.append(q_i)
print("丢包率：{0}".format(q))

fig= plt.figure(6)
plt.plot(q)
plt.title('Packet loss')
plt.xlabel('time')# make axis labels
plt.ylabel('packet loss')
plt.legend()

# --------------------------------------------throughput---------------------------------------------
T = []
G = []

for i in q:
    if i == 1:
        Gp = 0
    else:
        Gp = (1-P-i)*Tp
    G.append(Gp)
print("goodput：{0}".format(G))
T = [Tp]*len(G)
fig= plt.figure(7)
plt.plot(G, 'b', label = "Goodput")
plt.plot(T, 'r', label = "Throughput")
plt.title('Goodput & Throughput')
plt.xlabel('time')# make axis labels
plt.ylabel('throughput')
plt.legend()

# show the figure
plt.show()
